# BitzLayout

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

BitzLayoutは、BitzLabsエコシステムにおける「最後の共通中間表現」である**`LayoutAST`**の型定義を提供するライブラリです。

## `LayoutAST`とは

`LayoutAST`は、文書や図の論理的な構造（セマンティクス）が、具体的な描画情報（ジオメトリ）に変換された結果を表現します。ここには「見出し」や「タスク」といった意味情報は存在せず、「座標(10,20)にこのテキストを描画せよ」「この矩形を塗りつぶせ」といった、純粋な描画プリミティブのみが含まれます。

これは、BitzLabsアーキテクチャにおいて、**レイアウトエンジン**の**出力**であり、**各種レンダラー**の**入力**となります。

## 主な機能

-   **`LayoutAST`の型定義**: ページ、レイヤー、描画プリミティブ（ボックス、テキスト、線、パスなど）を表現する、厳密に型付けされたAST。
-   **高精度グラフィックス対応**: テキストのグリフ単位での配置、グラデーションやパターン塗り、クリッピングパス、透明度やブレンドモードといった、PDFやSVGが持つリッチなグラフィックス機能を表現できる構造を持ちます。
-   **構造化された描画命令**: 単なるプリミティブのリストではなく、`Group`ノードによる入れ子構造や変形（Transform）をサポートし、効率的なレンダリングを可能にします。

## ✅ 初期開発ToDoリスト

1.  **`ILayoutNode`インターフェースの定義**:
    *   `BitzAstCore`の`IAstNode`を継承した、`LayoutAST`ノードの基底インターフェースを定義。
2.  **基本構造ノードの定義**:
    *   `DocumentNode` (ルート)、`PageNode` (`width`, `height`を持つ)、`LayerNode` (`name`, `visible`を持つ) のクラスの「殻」を作成。
3.  **コンテナノードの定義**:
    *   `BoxNode` (矩形領域)、`GroupNode` (変形やスタイルを子に適用) のクラスの「殻」を作成。
4.  **プリミティブノードの定義**:
    *   `TextSpanNode` (単純なテキスト)、`PathNode` (SVG互換のパスデータ)、`ImageNode`など、基本的な描画要素のクラスの「殻」を作成。
5.  **スタイル関連の型定義**:
    *   `Style`クラス/構造体を定義し、`Fill`, `Stroke`, `StrokeWidth`などのプロパティを持たせる。グラデーションなどの複雑な塗りつぶしも考慮した設計にする。
    *   `Font`クラス/構造体を定義。

## このライブラリの位置づけ

`BitzLayout`は、ドメイン固有のロジック（`BitzPlot`など）と、出力形式固有のロジック（`BitzRenderers`）を分離するための、極めて重要な架け橋です。

この共通中間表現があるおかげで、新しい出力フォーマット（例: PowerPoint）に対応したくなった場合でも、新しいレンダラーを追加するだけで済み、各ドメインのレイアウトエンジンには一切手を入れる必要がありません。

### 依存関係

-   `BitzAstCore` (基底インターフェースを共有するため)
